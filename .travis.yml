language: python
python:
- '3.6'
sudo: required
services:
- docker
branches:
  only:
  - develop
before_install:
- docker version
install:
- docker pull kbase/kb-sdk
- docker run kbase/kb-sdk genscript > $HOME/bin/kb-sdk
- chmod 755 $HOME/bin/kb-sdk
- export PATH=$PATH:$HOME/bin/kb-sdk
- kb-sdk sdkbase
- kb-sdk test || true
- make build-test-script
- sed -i "s/test_token=/test_token=$TEST_TOKEN/" test_local/test.cfg
- sed -i "s/appdev./ci./" test_local/test.cfg
script:
- kb-sdk test
after_success:
- cp test_local/workdir/.coverage .
- sudo mkdir -p /kb/module/lib/
- sudo cp -R test_local/workdir/kb/module/lib/kb_tophat2 /kb/module/lib/
- coverage report -m
- coveralls
env:
  global:
    secure: SGjFJduSVfTKWXnW7J+NuLNqXKxwecKIAPmEkjE2/kRMCrPYmC/f+KYsv5lpmy+zMh2pbF101cYL1ILVnFcTAOg8rdSW6keA8HNCNK+GpLO61IidEhUVLSLQirCHTbOAQTRjIbetf6J8y64cWfPqFp+tdjlfVrR5GfyauZTgf+WEttGBRgt3q64FUgdha5OsrVYsKgg/AT/57gUeZIDipZNy+PJpC3ucwsUnRlA/OcTVVYjNJiCYEzOJ7Kdq7NbDjZkrWTstFAuAleMQaft3S3H3n0eeAt6XMRucVMOp7KRjOjgOMKd6HKos98uLFOQXKU/jbYpm7cdGnpVTA1UVTFF3NeTegKWdIZZJbkGBsHHpzlkrY3uZCMNXpD47cowmPw5kmqJqEj2FdRLA2BppiI1W6rsk+sKhp58xXViiQYCB04rJA4kyC70F898TA0Nlmeif94uvubOkQrHVZYkSP9/9+VCRGV7C8vq1ax4fUNPzhnS8SJK9Na+Hn+Z+A8pKcns6iP6vt8ThQp3N+NzhXCkilCJiZN5HwUhqX1h1T5JzJy4oIvMtC91RWMfVUiSsSeIUrBmF4o9OC8/TNVTatwCLwNSX+zCG+1w/rFvFf+p7NlaMmcAvLvxHm4D/3OOcFGTk9312acdHMuv1qkmhSmu/PjYpXwbSWrYyFMZS2s4=
